/* Cleaned up for recent modern refactor */